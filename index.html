<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Document</title>
  </head>
  <body>
    <form id="myForm" onsubmit="savetolocalstorage(event)">
      <label for="">Name</label>
      <input type="text" id="username" name="username" />
      <label>Email id</label>
      <input type="email" id="email" name="emailId" />
      <label for="">phone number</label>
      <input type="tel" id="phone" name="phone" />
      <button>submit</button>
    </form>

    <ul id="listofusers"></ul>
    <script src="https://cdn.jsdelivr.net/npm/axios@1.1.2/dist/axios.min.js"></script>
    <script>
      function savetolocalstorage(event) {
        event.preventDefault();
        const name = event.target.username.value;
        const email = event.target.emailId.value;
        const phone = event.target.phone.value;
        const obj = {
          name,
          email,
          phone,
        };
        axios
          .post(
            "https://crudcrud.com/api/7d3f73362e654c19b6b443727b91dac8/appointmentData",
            obj
          )
          .then((response) => {
            console.log(response);
          })
          .catch((err) => {
            console.log(err);
          });
        document.getElementById("myForm").reset();
        location.reload();
      }
      window.addEventListener("DOMContentLoaded", () => {
        axios
          .get(
            "https://crudcrud.com/api/7d3f73362e654c19b6b443727b91dac8/appointmentData"
          )
          .then((response) => {
            // console.log(response);
            for (var i = 0; i < response.data.length; i++) {
              showOutput(response.data[i]);
            }
          })
          .catch((err) => {
            console.log(err);
          });
      });

      function showOutput(user) {
        const list = document.getElementById("listofusers");
        let li = document.createElement("li");
        let del = document.createElement("button");
        del.setAttribute("id", `${user._id}`);
        const id = `${user._id}`;
        del.setAttribute("onclick", `delete1(id)`);
        let edit = document.createElement("button");
        edit.setAttribute("id", `${user._id}`);
        edit.setAttribute("onclick", "edit1(id)");

        del.innerHTML = "delete";
        edit.innerHTML = "Edit";
        li.innerHTML = `${user.name}- ${user.email} - ${user.phone}`;
        list.appendChild(li);
        list.appendChild(del);
        list.appendChild(edit);
      }
      function delete1(id) {
        console.log(id);
        // alert("delete !");
        axios
          .delete(
            `https://crudcrud.com/api/7d3f73362e654c19b6b443727b91dac8/appointmentData/` +
              id
          )
          .then((response) => {
            console.log(response);
            location.reload();
          })
          .catch((err) => {
            console.log(err);
          });
      }
    </script>
  </body>
</html>
